
# 📄 文档生成器前端功能与交互说明（适用于 Word 与 Excel 模板）

---

## 🧩 页面结构分区说明

整个页面包含三大区域：

1. **顶部操作区**：用于模板上传、类型选择、数据导入导出。
2. **左侧编辑区**：用于定义字段、编辑模板结构。
3. **右侧预览区**：用于填写数据、实时预览生成文档内容。

---

## ✅ 功能组件与交互说明（Word 与 Excel 共通）

### 1. 模板类型选择

- 用户可以选择两种模板类型：Word 或 Excel。
- 切换类型时，会清空所有编辑器、字段列表、数据填充内容与预览。
- 模板编辑方式与预览方式根据类型自动切换。

---

### 2. 模板上传

- 支持 .docx（Word）或 .xlsx（Excel）文件上传。
- 解析文件内容并加载到编辑器。
- 可识别已有字段并自动同步字段列表与数据填充区。

---

### 3. 字段定义（左侧）

#### 普通字段（键值对）

- 输入字段名后点击 `＋` 添加。
- 添加后自动出现在字段列表中，并在右侧生成对应输入框。
- 删除字段时同步清除：
  - 字段列表
  - 字段填充输入框
  - 模板中占位符

#### 列表字段（对象列表）

- 定义列表名后点击 `＋` 添加。
- 每个列表可添加多个字段（属性），支持字段插入与删除。
- 同步影响右侧数据表格列结构。
- 删除列表字段会清除：
  - 左侧列表结构
  - 右侧表格
  - 模板中的列表占位符

---

### 4. 模板编辑区域

- Word 类型：多行文本区域，支持 Mustache 模板语法。
- Excel 类型：可编辑表格结构，单元格可填写占位符。
- 字段点击或双击插入到编辑器光标位置。
- 删除字段同步清除所有相关占位符。

---

### 5. 字段填充区域（右上）

#### 普通字段

- 每个字段有输入框。
- 值更新后实时替换预览内容。

#### 列表字段

- 自动生成动态表格，每行代表一个对象，每列代表属性。
- 行操作：
  - `＋`：在当前行下方插入
  - `×`：删除当前行
- 字段结构更新将同步变更列结构。

---

### 6. 实时预览区域（右下）

- 自动监听字段填充值，实时渲染完整文档。
- 替换所有占位符（普通字段与列表字段）。
- 展示风格与模板类型一致（文本 or 表格）。

---

### 7. 导出与操作按钮

| 按钮名称 | 功能 |
|----------|------|
| 保存模板 | 保存模板，覆盖原模板 |
| 生成模板 | 生成新模板，文件名为模板名+时间戳 |
| 生成文档 | 将当前填充数据渲染为文档并下载 |
| 预览PDF | 实时渲染并预览 PDF |
| 导出字段 | 导出字段结构为 JSON/表格 |
| 导入数据 | 从 Excel 导入数据填充字段 |

---

## 🔁 交互逻辑与联动关系

```
字段定义区 ↔ 模板编辑器（插入/删除占位符）
字段定义区 ↔ 字段填充区（同步输入框或列结构）
字段填充区 ↔ 模板预览区（实时渲染内容）
模板类型选择 → 模板结构清空 + 编辑器切换
上传模板 → 同步字段识别、结构加载
```

---

本说明可用于：
- Cursor 等代码生成工具 prompt 输入
- Java / JavaFX / Mustache 模板集成开发
- 前端 JS 或 HTML 原型重建
