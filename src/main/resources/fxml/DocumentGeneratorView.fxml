<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.geometry.Insets?>
<?import javafx.collections.FXCollections?>
<?import java.lang.String?>

<VBox fx:id="mainPane" xmlns="http://javafx.com/javafx"
      xmlns:fx="http://javafx.com/fxml"
      fx:controller="com.timelordtty.docgen.controller.DocumentGeneratorController"
      prefHeight="800.0" prefWidth="1200.0"
      stylesheets="@../css/styles.css">
    
    <SplitPane fx:id="mainSplitPane" orientation="VERTICAL" VBox.vgrow="ALWAYS" dividerPositions="0.15">
        <!-- 顶部按钮区域 -->
        <VBox spacing="10" styleClass="content-section">
            <padding>
                <Insets top="10" right="10" bottom="10" left="10"/>
            </padding>
            
            <HBox spacing="10" alignment="CENTER_LEFT">
                <Label text="文档生成器" styleClass="title-label"/>
                <Region HBox.hgrow="ALWAYS"/>
                <Label text="当前模式:"/>
                
                <fx:define>
                    <ToggleGroup fx:id="modeToggleGroup"/>
                </fx:define>
                
                <RadioButton fx:id="wordModeRadio" text="Word" selected="true" 
                             onAction="#handleWordModeSelect" styleClass="action-button"
                             toggleGroup="$modeToggleGroup"/>
                <RadioButton fx:id="excelModeRadio" text="Excel" 
                             onAction="#handleExcelModeSelect" styleClass="action-button"
                             toggleGroup="$modeToggleGroup"/>
                             
                <!-- 添加模板类型ComboBox -->
                <Label text="模板类型:" styleClass="field-label"/>
                <ComboBox fx:id="templateTypeComboBox" prefWidth="120">
                    <items>
                        <FXCollections fx:factory="observableArrayList">
                            <String fx:value="Word"/>
                            <String fx:value="Excel"/>
                        </FXCollections>
                    </items>
                </ComboBox>
            </HBox>
            
            <HBox spacing="10" alignment="CENTER_LEFT">
                <Label text="操作:"/>
                <Button text="导入模板" onAction="#handleImportTemplate" styleClass="action-button"/>
                <Button text="导出字段" onAction="#handleExportFields" styleClass="action-button"/>
                <Button text="生成文档" onAction="#handleGenerateDocument" styleClass="action-button"/>
                <Label text="当前模板:"/>
                <Label fx:id="templateNameLabel" text="无" styleClass="field-label"/>
            </HBox>
        </VBox>
        
        <!-- 下方内容区域 -->
        <SplitPane fx:id="contentSplitPane" dividerPositions="0.5">
            <!-- 左侧分割区域 - 字段定义和数据填充 -->
            <SplitPane orientation="VERTICAL" dividerPositions="0.5">
                <!-- 字段定义区域 -->
                <VBox spacing="10" styleClass="content-section">
                    <padding>
                        <Insets top="10" right="10" bottom="10" left="10"/>
                    </padding>
                    
                    <HBox spacing="10" alignment="CENTER_LEFT">
                        <Label text="字段定义" styleClass="section-title"/>
                        <Region HBox.hgrow="ALWAYS"/>
                        <Button text="添加字段" onAction="#handleAddField" styleClass="action-button"/>
                        <Button text="添加列表" onAction="#handleAddListField" styleClass="action-button"/>
                    </HBox>
                    
                    <TextField fx:id="objectFieldInput" promptText="输入字段名称" HBox.hgrow="ALWAYS"/>
                    
                    <ScrollPane fx:id="fieldItemsScrollPane" VBox.vgrow="ALWAYS" fitToWidth="true" styleClass="field-scroll-pane">
                        <VBox fx:id="objectFieldItemsContainer" spacing="10"/>
                    </ScrollPane>
                    
                    <TextField fx:id="listFieldInput" promptText="输入列表名称" HBox.hgrow="ALWAYS"/>
                    
                    <ScrollPane fx:id="listFieldItemsScrollPane" VBox.vgrow="ALWAYS" fitToWidth="true" styleClass="field-scroll-pane">
                        <VBox fx:id="listFieldItemsContainer" spacing="10"/>
                    </ScrollPane>
                </VBox>
                
                <!-- 数据填充区域 -->
                <VBox spacing="10" styleClass="content-section">
                    <padding>
                        <Insets top="10" right="10" bottom="10" left="10"/>
                    </padding>
                    
                    <HBox spacing="10" alignment="CENTER_LEFT">
                        <Label text="数据填充" styleClass="section-title"/>
                        <Region HBox.hgrow="ALWAYS"/>
                        <Button text="导入数据" onAction="#handleImportData" styleClass="action-button"/>
                        <Button text="保存数据" onAction="#handleSaveData" styleClass="action-button"/>
                    </HBox>
                    
                    <ScrollPane fx:id="dataItemsScrollPane" VBox.vgrow="ALWAYS" fitToWidth="true" styleClass="field-scroll-pane">
                        <VBox fx:id="objectDataItemsContainer" spacing="10"/>
                    </ScrollPane>
                    
                    <ScrollPane fx:id="listDataItemsScrollPane" VBox.vgrow="ALWAYS" fitToWidth="true" styleClass="field-scroll-pane">
                        <VBox fx:id="listDataItemsContainer" spacing="10"/>
                    </ScrollPane>
                </VBox>
            </SplitPane>
            
            <!-- 右侧分割区域 - 模板编辑和预览 -->
            <SplitPane orientation="VERTICAL" dividerPositions="0.5">
                <!-- 模板编辑区域 -->
                <VBox spacing="10" styleClass="content-section">
                    <padding>
                        <Insets top="10" right="10" bottom="10" left="10"/>
                    </padding>
                    
                    <HBox spacing="10" alignment="CENTER_LEFT">
                        <Label text="模板编辑" styleClass="section-title"/>
                        <Region HBox.hgrow="ALWAYS"/>
                        <Button text="保存模板" onAction="#handleSaveTemplate" styleClass="action-button"/>
                    </HBox>
                    
                    <StackPane VBox.vgrow="ALWAYS">
                        <!-- Word模式下的编辑器 -->
                        <TextArea fx:id="wordEditor" promptText="导入Word模板后在此编辑..." 
                                 wrapText="true" visible="true" styleClass="template-editor"/>
                        
                        <!-- Excel模式下的表格编辑器 -->
                        <TableView fx:id="excelEditor" visible="false" styleClass="template-editor">
                            <!-- 表格列会动态添加 -->
                        </TableView>
                    </StackPane>
                </VBox>
                
                <!-- 预览区域 -->
                <VBox spacing="10" styleClass="content-section">
                    <padding>
                        <Insets top="10" right="10" bottom="10" left="10"/>
                    </padding>
                    
                    <HBox spacing="10" alignment="CENTER_LEFT">
                        <Label text="预览" styleClass="section-title"/>
                        <Region HBox.hgrow="ALWAYS"/>
                    </HBox>
                    
                    <ScrollPane fx:id="previewScrollPane" VBox.vgrow="ALWAYS" fitToWidth="true" styleClass="preview-scroll-pane">
                        <StackPane>
                            <!-- Word模式下的预览 -->
                            <TextArea fx:id="wordPreviewArea" editable="false" wrapText="true" 
                                      styleClass="preview-area" visible="true"/>
                            
                            <!-- Excel模式下的预览 -->
                            <TableView fx:id="excelPreviewArea" styleClass="preview-area" visible="false">
                                <!-- 表格列会动态添加 -->
                            </TableView>
                        </StackPane>
                    </ScrollPane>
                </VBox>
            </SplitPane>
        </SplitPane>
    </SplitPane>
</VBox> 