import{x as e,r as a,c as l,w as t,k as r,y as u,P as n,H as o,I as s,ag as i,aq as d,A as c,L as p,M as v,u as m,G as w,J as f,a4 as C,az as g,z as _}from"./vue-CYQ3jvsg.js";import{u as h,P as E}from"./project-B2gwCvL8.js";import{b,s as y,p as k,E as D}from"./elementPlus-D3jm9WeK.js";import{_ as L}from"./index-CSUhv2L2.js";import"./index-fZjk1EK6.js";const j={class:"project-list-container"},P={class:"card-header"},V={class:"header-right"},z={class:"project-details"},T={class:"pagination-container"},A={class:"dialog-footer"},I=L(e({__name:"ProjectListView",setup(e){const L=g(),I=h(),x=a(!1),N=a(""),R=a("all"),M=a(1),U=a(10),O=a(!1),S=a(null),X=l((()=>"all"===R.value?I.projects:I.projects.filter((e=>e.status===R.value)))),$=l((()=>{const e=N.value.toLowerCase().trim();return e?G.value.filter((a=>a.name.toLowerCase().includes(e)||a.remark&&a.remark.toLowerCase().includes(e))):G.value})),q=l((()=>X.value.length)),G=l((()=>{const e=(M.value-1)*U.value,a=e+U.value;return X.value.slice(e,a)})),H=e=>e?new Date(e).toLocaleDateString("zh-CN"):"未设置",J=e=>e?new Date(e).toLocaleString("zh-CN"):"未设置",K=e=>{switch(e){case"ACTIVE":return"primary";case"COMPLETED":return"success";case"CANCELLED":return"danger";case"EXPIRED":return"info";default:return""}},B=e=>{switch(e){case"ACTIVE":return"进行中";case"COMPLETED":return"已完成";case"CANCELLED":return"已取消";case"EXPIRED":return"已过期";default:return"未知"}},F=()=>{M.value=1},Q=()=>{M.value=1},W=e=>{U.value=e,M.value=1},Y=e=>{M.value=e},Z=()=>{O.value=!1,S.value=null},ee=async()=>{if(S.value)try{await I.removeProject(S.value.id)?(D.success("删除成功"),O.value=!1,S.value=null):D.error("删除失败")}catch(e){D.error("删除失败")}},ae=async(e,a)=>{try{const l={...e,status:a};await I.saveProject(l),D.success("状态更新成功")}catch(l){D.error("状态更新失败")}};return t([N],(()=>{M.value=1})),r((()=>{(async()=>{x.value=!0;try{await I.fetchAllProjects()}finally{x.value=!1}})()})),(e,a)=>{const l=i("el-icon"),t=i("el-input"),r=i("el-button"),g=i("el-tab-pane"),h=i("el-tabs"),D=i("el-table-column"),I=i("el-tag"),X=i("el-dropdown-item"),G=i("el-dropdown-menu"),le=i("el-dropdown"),te=i("el-button-group"),re=i("el-table"),ue=i("el-pagination"),ne=i("el-card"),oe=i("el-dialog"),se=d("loading");return _(),u("div",j,[n(ne,{shadow:"never"},{header:o((()=>[c("div",P,[a[8]||(a[8]=c("div",{class:"header-left"},[c("h2",null,"项目列表")],-1)),c("div",V,[n(t,{modelValue:N.value,"onUpdate:modelValue":a[0]||(a[0]=e=>N.value=e),placeholder:"搜索项目",clearable:"",onKeyup:C(F,["enter"]),class:"search-input"},{prefix:o((()=>[n(l,null,{default:o((()=>[n(m(y))])),_:1})])),_:1},8,["modelValue"]),n(r,{type:"primary",onClick:a[1]||(a[1]=a=>e.$router.push("/project/add"))},{default:o((()=>[n(l,null,{default:o((()=>[n(m(k))])),_:1}),a[7]||(a[7]=p(" 添加项目 "))])),_:1})])])])),default:o((()=>[n(h,{modelValue:R.value,"onUpdate:modelValue":a[2]||(a[2]=e=>R.value=e),onTabClick:Q},{default:o((()=>[n(g,{label:"所有项目",name:"all"}),n(g,{label:"进行中",name:"ACTIVE"}),n(g,{label:"已完成",name:"COMPLETED"}),n(g,{label:"已取消",name:"CANCELLED"}),n(g,{label:"已过期",name:"EXPIRED"})])),_:1},8,["modelValue"]),s((_(),u("div",null,[n(re,{data:$.value,style:{width:"100%"},border:""},{default:o((()=>[n(D,{type:"expand"},{default:o((e=>[c("div",z,[c("p",null,[a[9]||(a[9]=c("strong",null,"项目备注：",-1)),p(" "+v(e.row.remark||"无"),1)]),c("p",null,[a[10]||(a[10]=c("strong",null,"上网日期：",-1)),p(" "+v(H(e.row.onlineDate)),1)]),c("p",null,[a[11]||(a[11]=c("strong",null,"报名截止日期：",-1)),p(" "+v(H(e.row.registrationEndDate)),1)]),c("p",null,[a[12]||(a[12]=c("strong",null,"最早评审日期：",-1)),p(" "+v(H(e.row.earliestReviewDate)),1)]),c("p",null,[a[13]||(a[13]=c("strong",null,"开标时间：",-1)),p(" "+v(J(e.row.expectedReviewTime)),1)]),c("p",null,[a[14]||(a[14]=c("strong",null,"专家评审时间：",-1)),p(" "+v(J(e.row.expertReviewTime)),1)])])])),_:1}),n(D,{prop:"id",label:"ID",width:"80"}),n(D,{prop:"name",label:"项目名称","min-width":"200"}),n(D,{label:"评审周期",width:"100"},{default:o((e=>[p(v(e.row.reviewPeriod)+" 天 ",1)])),_:1}),n(D,{label:"上网日期",width:"120"},{default:o((e=>[p(v(H(e.row.onlineDate)),1)])),_:1}),n(D,{label:"状态",width:"100"},{default:o((e=>[n(I,{type:K(e.row.status)},{default:o((()=>[p(v(B(e.row.status)),1)])),_:2},1032,["type"])])),_:1}),n(D,{label:"操作",width:"200",fixed:"right"},{default:o((e=>[n(te,null,{default:o((()=>[n(r,{size:"small",type:"primary",onClick:a=>{return l=e.row,void L.push(`/project/edit/${l.id}`);var l}},{default:o((()=>a[15]||(a[15]=[p(" 编辑 ")]))),_:2},1032,["onClick"]),n(r,{size:"small",type:"danger",onClick:a=>{return l=e.row,S.value=l,void(O.value=!0);var l}},{default:o((()=>a[16]||(a[16]=[p(" 删除 ")]))),_:2},1032,["onClick"]),n(le,null,{dropdown:o((()=>[n(G,null,{default:o((()=>[n(X,{onClick:a=>ae(e.row,m(E).COMPLETED)},{default:o((()=>a[17]||(a[17]=[p(" 标记为已完成 ")]))),_:2},1032,["onClick"]),n(X,{onClick:a=>ae(e.row,m(E).CANCELLED)},{default:o((()=>a[18]||(a[18]=[p(" 标记为已取消 ")]))),_:2},1032,["onClick"]),"ACTIVE"!==e.row.status?(_(),w(X,{key:0,onClick:a=>ae(e.row,m(E).ACTIVE)},{default:o((()=>a[19]||(a[19]=[p(" 恢复为进行中 ")]))),_:2},1032,["onClick"])):f("",!0)])),_:2},1024)])),default:o((()=>[n(r,{size:"small"},{default:o((()=>[n(l,null,{default:o((()=>[n(m(b))])),_:1})])),_:1})])),_:2},1024)])),_:2},1024)])),_:1})])),_:1},8,["data"]),c("div",T,[n(ue,{"current-page":M.value,"onUpdate:currentPage":a[3]||(a[3]=e=>M.value=e),"page-size":U.value,"onUpdate:pageSize":a[4]||(a[4]=e=>U.value=e),"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",total:q.value,onSizeChange:W,onCurrentChange:Y},null,8,["current-page","page-size","total"])])])),[[se,x.value]])])),_:1}),n(oe,{modelValue:O.value,"onUpdate:modelValue":a[6]||(a[6]=e=>O.value=e),title:"确认删除",width:"30%","before-close":Z},{footer:o((()=>[c("span",A,[n(r,{onClick:a[5]||(a[5]=e=>O.value=!1)},{default:o((()=>a[20]||(a[20]=[p("取消")]))),_:1}),n(r,{type:"danger",onClick:ee},{default:o((()=>a[21]||(a[21]=[p("确定")]))),_:1})])])),default:o((()=>{var e;return[c("div",null,'确定要删除项目"'+v(null==(e=S.value)?void 0:e.name)+'"吗？此操作不可撤销！',1)]})),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-965897e6"]]);export{I as default};
