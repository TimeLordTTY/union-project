import{a as e}from"./index-fZjk1EK6.js";import{A as l}from"./config-CPUpIrL5.js";import{E as a}from"./elementPlus-D3jm9WeK.js";import{x as t,r as u,c as i,y as o,A as n,I as s,aq as d,G as p,H as m,P as r,ag as c,L as v,z as f}from"./vue-CYQ3jvsg.js";import{_ as F}from"./index-CSUhv2L2.js";const _={class:"doc-generator"},x=F(t({__name:"DocGeneratorView",setup(t){const F=u(!1),x=u({templateFile:null,dataFile:null,outputFilename:""}),b=u([]),y=u([]),h=i((()=>x.value.templateFile&&x.value.dataFile)),w=e=>{x.value.templateFile=e.file,b.value=[{name:e.file.name,url:""}]},j=()=>{x.value.templateFile=null,b.value=[]},g=e=>{x.value.dataFile=e.file,y.value=[{name:e.file.name,url:""}]},V=()=>{x.value.dataFile=null,y.value=[]},C=async()=>{if(h.value){F.value=!0;try{const t=new FormData;t.append("templateFile",x.value.templateFile),t.append("dataFile",x.value.dataFile),x.value.outputFilename&&t.append("outputFilename",x.value.outputFilename);const u=await e.post(l.docGenerator.generate,t,{responseType:"blob"}),i=window.URL.createObjectURL(new Blob([u.data])),o=document.createElement("a");o.href=i,o.setAttribute("download",x.value.outputFilename||"生成的文档.zip"),document.body.appendChild(o),o.click(),document.body.removeChild(o),a.success("文档生成成功")}catch(t){a.error("生成文档失败，请检查模板和数据文件")}finally{F.value=!1}}else a.warning("请先上传模板文件和数据文件")};return(e,l)=>{const a=c("el-button"),t=c("el-upload"),u=c("el-form-item"),i=c("el-input"),L=c("el-form"),E=d("loading");return f(),o("div",_,[l[6]||(l[6]=n("h1",null,"文档生成工具",-1)),s((f(),p(L,{model:x.value,"label-width":"120px"},{default:m((()=>[r(u,{label:"模板文件"},{default:m((()=>[r(t,{action:"#","http-request":w,"on-remove":j,"file-list":b.value,limit:1,accept:".docx,.xlsx,.xls"},{tip:m((()=>l[2]||(l[2]=[n("div",{class:"el-upload__tip"}," 支持的格式：Word (.docx) 或 Excel (.xlsx/.xls) ",-1)]))),default:m((()=>[r(a,{type:"primary"},{default:m((()=>l[1]||(l[1]=[v("选择模板文件")]))),_:1})])),_:1},8,["file-list"])])),_:1}),r(u,{label:"数据文件"},{default:m((()=>[r(t,{action:"#","http-request":g,"on-remove":V,"file-list":y.value,limit:1,accept:".json,.xml,.csv"},{tip:m((()=>l[4]||(l[4]=[n("div",{class:"el-upload__tip"}," 支持的格式：JSON (.json)、XML (.xml) 或 CSV (.csv) ",-1)]))),default:m((()=>[r(a,{type:"primary"},{default:m((()=>l[3]||(l[3]=[v("选择数据文件")]))),_:1})])),_:1},8,["file-list"])])),_:1}),r(u,{label:"输出文件名"},{default:m((()=>[r(i,{modelValue:x.value.outputFilename,"onUpdate:modelValue":l[0]||(l[0]=e=>x.value.outputFilename=e),placeholder:"输出文件名"},null,8,["modelValue"])])),_:1}),r(u,null,{default:m((()=>[r(a,{type:"primary",onClick:C,disabled:!h.value},{default:m((()=>l[5]||(l[5]=[v(" 生成文档 ")]))),_:1},8,["disabled"])])),_:1})])),_:1},8,["model"])),[[E,F.value]]),l[7]||(l[7]=n("div",{class:"tips"},[n("h3",null,"使用说明："),n("ul",null,[n("li",null,'上传Word或Excel模板文件，模板中使用 {"{"{varName}"}"} 格式的占位符'),n("li",null,"上传包含数据的JSON、XML或CSV文件，文件中的数据将用于替换模板中的占位符"),n("li",null,"支持批量生成，数据文件中可包含多组数据")])],-1))])}}}),[["__scopeId","data-v-349e1d47"]]);export{x as default};
